#!/usr/bin/env Rscript

sampleID <- "MalePOA"
directory <- "MalePOAIntact/outs/filtered_feature_bc_matrix"
output <- "Seurat/BNST_IndependentAnalysis/BNST_Merge_Paperplots"

library(Seurat)
library(cowplot)
library(reticulate)
library(ggplot2)
library(dplyr)
library(MAST)

mySeurat <- readRDS("Seurat/BNST_IndependentAnalysis/BNST_Fullmerge_Test_20pcs.rds")
DefaultAssay(mySeurat) <- "RNA"
mySeurat <- NormalizeData(mySeurat)
genes.10x <- (x=rownames(x=mySeurat))
unlist(genes.10x)
UpMale <- read.table("Genelists/BNST_ModuleScore_DetectedTest.txt")
unlist(UpMale)
UpMale <- as.matrix(UpMale)
UpMale.filtered <- intersect(UpMale, genes.10x)
mySeurat <- AddModuleScore(
object = mySeurat,
features = list(UpMale.filtered),
name = 'UpMale.score'
)
UpPrimed <- read.table("Genelists/BNST_eDEGs.txt")
unlist(UpPrimed)
UpPrimed <- as.matrix(UpPrimed)
UpPrimed.filtered <- intersect(UpPrimed, genes.10x)
mySeurat <- AddModuleScore(
object = mySeurat,
features = list(UpPrimed.filtered),
name = 'UpPrimed.score'
)
UpFemale <- read.table("Genelists/BNST_UpPrimedvMale.txt")
unlist(UpFemale)
UpFemale <- as.matrix(UpFemale)
UpFemale.filtered <- intersect(UpFemale, genes.10x)
mySeurat <- AddModuleScore(
object = mySeurat,
features = list(UpFemale.filtered),
name = 'UpFemale.score'
)
pdf(paste0(output,"_upmale_sexsplit.pdf"))
FeaturePlot(mySeurat, features=c("UpMale.score1"), split.by="sex", col=c("blue","orange"), order=TRUE, min.cutoff=0.2)
dev.off()
pdf(paste0(output,"_UMAP.pdf"))
DimPlot(mySeurat, reduction="umap", label=FALSE)
dev.off()
pdf(paste0(output,"_UMAP_conlabel.pdf"))
DimPlot(mySeurat, reduction="umap", group.by="Hormone", label=FALSE)
dev.off()
pdf(paste0(output,"_upmale_hormonesplit.pdf"))
FeaturePlot(mySeurat, features=c("UpMale.score1"), split.by="Hormone", col=c("blue","orange"), order=TRUE, min.cutoff=0.2)
dev.off()
pdf(paste0(output,"_upmale_sexsplit.pdf"))
FeaturePlot(mySeurat, features=c("UpMale.score1"), split.by="sex", col=c("blue","orange"), order=TRUE, min.cutoff=0.2)
dev.off()
pdf(paste0(output,"_upmale.pdf"))
FeaturePlot(mySeurat, features=c("UpMale.score1"), col=c("blue","orange"), order=TRUE, min.cutoff=0.2)
dev.off()
pdf(paste0(output,"upmaleVln.pdf"), width=20)
VlnPlot(mySeurat, features=c("UpMale.score1"), pt.size=0)
dev.off()
pdf(paste0(output,"upmaleVln_sexsplit.pdf"), width=20)
VlnPlot(mySeurat, features=c("UpMale.score1"), split.by="sex", pt.size=0)
dev.off()
pdf(paste0(output,"upmaleVln_hormonesplit.pdf"), width=20)
VlnPlot(mySeurat, features=c("UpMale.score1"), split.by="Hormone", pt.size=0)
dev.off()
pdf(paste0(output,"_upfemale_sexsplit.pdf"))
FeaturePlot(mySeurat, features=c("UpFemale.score1"), split.by="sex", col=c("blue","orange"), order=TRUE)
dev.off()
pdf(paste0(output,"_upfemale_hormonesplit.pdf"))
FeaturePlot(mySeurat, features=c("UpFemale.score1"), split.by="Hormone", col=c("blue","orange"), order=TRUE)
dev.off()
pdf(paste0(output,"_upfemale_sexsplit.pdf"))
FeaturePlot(mySeurat, features=c("UpFemale.score1"), split.by="sex", col=c("blue","orange"), order=TRUE)
dev.off()
pdf(paste0(output,"_upfemale.pdf"))
FeaturePlot(mySeurat, features=c("UpFemale.score1"), col=c("blue","orange"), order=TRUE)
dev.off()
pdf(paste0(output,"upfemaleVln.pdf"), width=20)
VlnPlot(mySeurat, features=c("UpFemale.score1"), pt.size=0)
dev.off()
pdf(paste0(output,"upfemaleVln_sexsplit.pdf"), width=20)
VlnPlot(mySeurat, features=c("UpFemale.score1"), split.by="sex", pt.size=0)
dev.off()
pdf(paste0(output,"upfemaleVln_hormonesplit.pdf"), width=20)
VlnPlot(mySeurat, features=c("UpFemale.score1"), split.by="Hormone", pt.size=0)
dev.off()
pdf(paste0(output,"nUMI.pdf"), width=20)
VlnPlot(mySeurat, features=c("nCount_RNA"), split.by="Hormone", pt.size=0)
dev.off()
pdf(paste0(output,"_upprimed_sexsplit.pdf"))
FeaturePlot(mySeurat, features=c("UpPrimed.score1"), split.by="sex", col=c("blue","orange"), order=TRUE)
dev.off()
pdf(paste0(output,"_upprimed_hormonesplit.pdf"))
FeaturePlot(mySeurat, features=c("UpPrimed.score1"), split.by="Hormone", col=c("blue","orange"), order=TRUE)
dev.off()
pdf(paste0(output,"_upprimed_sexsplit.pdf"))
FeaturePlot(mySeurat, features=c("UpPrimed.score1"), split.by="sex", col=c("blue","orange"), order=TRUE)
dev.off()
pdf(paste0(output,"_upprimed.pdf"))
FeaturePlot(mySeurat, features=c("UpPrimed.score1"), col=c("blue","orange"), order=TRUE)
dev.off()
pdf(paste0(output,"upprimedVln.pdf"), width=20)
VlnPlot(mySeurat, features=c("UpPrimed.score1"), pt.size=0)
dev.off()
pdf(paste0(output,"upprimedVln_sexsplit.pdf"), width=20)
VlnPlot(mySeurat, features=c("UpPrimed.score1"), split.by="sex", pt.size=0)
dev.off()
pdf(paste0(output,"upprimedVln_hormonesplit.pdf"), width=20)
VlnPlot(mySeurat, features=c("UpPrimed.score1"), split.by="Hormone", pt.size=0)
dev.off()
pdf(paste0(output,"Tac1.pdf"), width=20)
VlnPlot(mySeurat, features=c("Tac1"), pt.size=0)
dev.off()